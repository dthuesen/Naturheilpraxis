try{"undefined"===typeof WeakMap&&function(){var d=Object.defineProperty,z=Date.now()%1E9,a=function(){this.name="__st"+(1E9*Math.random()>>>0)+(z++ +"__")};a.prototype={set:function(a,f){var c=a[this.name];c&&c[0]===a?c[1]=f:d(a,this.name,{value:[a,f],writable:!0})},get:function(a){var f;return(f=a[this.name])&&f[0]===a?f[1]:void 0}};window.WeakMap=a}()}catch(e$$12){};try{(function(d){function z(){p=!1;var b=v;v=[];b.sort(function(a,b){return a.uid_-b.uid_});var k=!1;b.forEach(function(b){var e=b.takeRecords();a(b);e.length&&(b.callback_(e,b),k=!0)});k&&z()}function a(a){a.nodes_.forEach(function(b){(b=k.get(b))&&b.forEach(function(b){b.observer===a&&b.removeTransientObservers()})})}function q(a,b){for(var e=a;e;e=e.parentNode){var c=k.get(e);if(c)for(var g=0;g<c.length;g++){var l=c[g],m=l.options;(e===a||m.subtree)&&(m=b(m))&&l.enqueue(m)}}}function f(a){this.callback_=
a;this.nodes_=[];this.records_=[];this.uid_=++r}function c(a,b){this.type=a;this.target=b;this.addedNodes=[];this.removedNodes=[];this.oldValue=this.attributeNamespace=this.attributeName=this.nextSibling=this.previousSibling=null}function g(a,b){return u=new c(a,b)}function b(a){if(t)return t;var b=u,e=new c(b.type,b.target);e.addedNodes=b.addedNodes.slice();e.removedNodes=b.removedNodes.slice();e.previousSibling=b.previousSibling;e.nextSibling=b.nextSibling;e.attributeName=b.attributeName;e.attributeNamespace=
b.attributeNamespace;e.oldValue=b.oldValue;t=e;t.oldValue=a;return t}function e(a,b,e){this.observer=a;this.target=b;this.options=e;this.transientObservedNodes=[]}var k=new WeakMap,l=window.msSetImmediate;if(!l){var m=[],h=String(Math.random());window.addEventListener("message",function(a){a.data===h&&(a=m,m=[],a.forEach(function(a){a()}))});l=function(a){m.push(a);window.postMessage(h,"*")}}var p=!1,v=[],r=0;f.prototype={observe:function(a,b){a=window.ShadowDOMPolyfill&&window.ShadowDOMPolyfill.wrapIfNeeded(a)||
a;if(!b.childList&&!b.attributes&&!b.characterData||b.attributeOldValue&&!b.attributes||b.attributeFilter&&b.attributeFilter.length&&!b.attributes||b.characterDataOldValue&&!b.characterData)throw new SyntaxError;var c=k.get(a);c||k.set(a,c=[]);for(var g,l=0;l<c.length;l++)if(c[l].observer===this){g=c[l];g.removeListeners();g.options=b;break}g||(g=new e(this,a,b),c.push(g),this.nodes_.push(a));g.addListeners()},disconnect:function(){this.nodes_.forEach(function(a){a=k.get(a);for(var b=0;b<a.length;b++){var e=
a[b];if(e.observer===this){e.removeListeners();a.splice(b,1);break}}},this);this.records_=[]},takeRecords:function(){var a=this.records_;this.records_=[];return a}};var u,t;e.prototype={enqueue:function(a){var b=this.observer.records_,e=b.length;if(0<b.length){var k=b[e-1];k=k===a?k:!t||k!==t&&k!==u?null:t;if(k){b[e-1]=k;return}}else v.push(this.observer),p||(p=!0,l(z));b[e]=a},addListeners:function(){this.addListeners_(this.target)},addListeners_:function(a){var b=this.options;b.attributes&&a.addEventListener("DOMAttrModified",
this,!0);b.characterData&&a.addEventListener("DOMCharacterDataModified",this,!0);b.childList&&a.addEventListener("DOMNodeInserted",this,!0);(b.childList||b.subtree)&&a.addEventListener("DOMNodeRemoved",this,!0)},removeListeners:function(){this.removeListeners_(this.target)},removeListeners_:function(a){var b=this.options;b.attributes&&a.removeEventListener("DOMAttrModified",this,!0);b.characterData&&a.removeEventListener("DOMCharacterDataModified",this,!0);b.childList&&a.removeEventListener("DOMNodeInserted",
this,!0);(b.childList||b.subtree)&&a.removeEventListener("DOMNodeRemoved",this,!0)},addTransientObserver:function(a){if(a!==this.target){this.addListeners_(a);this.transientObservedNodes.push(a);var b=k.get(a);b||k.set(a,b=[]);b.push(this)}},removeTransientObservers:function(){var a=this.transientObservedNodes;this.transientObservedNodes=[];a.forEach(function(a){this.removeListeners_(a);a=k.get(a);for(var b=0;b<a.length;b++)if(a[b]===this){a.splice(b,1);break}},this)},handleEvent:function(a){switch(a.type){case "DOMAttrModified":var e=
a.attrName,k=a.relatedNode.namespaceURI,c=a.target,l=new g("attributes",c);l.attributeName=e;l.attributeNamespace=k;var m=a.attrChange===MutationEvent.ADDITION?null:a.prevValue;q(c,function(a){if(a.attributes&&(!a.attributeFilter||!a.attributeFilter.length||-1!==a.attributeFilter.indexOf(e)||-1!==a.attributeFilter.indexOf(k)))return a.attributeOldValue?b(m):l});break;case "DOMCharacterDataModified":c=a.target;l=g("characterData",c);m=a.prevValue;q(c,function(a){if(a.characterData)return a.characterDataOldValue?
b(m):l});break;case "DOMNodeRemoved":this.addTransientObserver(a.target);case "DOMNodeInserted":var c=a.relatedNode,h=a.target,f;"DOMNodeInserted"===a.type?(a=[h],f=[]):(a=[],f=[h]);var p=h.previousSibling,h=h.nextSibling,l=g("childList",c);l.addedNodes=a;l.removedNodes=f;l.previousSibling=p;l.nextSibling=h;q(c,function(a){if(a.childList)return l})}u=t=void 0}};d.JsMutationObserver=f;!d.MutationObserver&&d.WebKitMutationObserver&&(d.MutationObserver=d.WebKitMutationObserver);d.MutationObserver||(d.MutationObserver=
f)})(this)}catch(e$$15){};(function(){var d;(function(a){a.EVENT_MUT_INSERT=2;a.EVENT_MUT_REMOVE=3;a.EVENT_MUT_ATTR=4;a.EVENT_MUT_ATTR_CURVE=5;a.EVENT_MUT_TEXT=6;a.EVENT_MUT_SKIPIDS=7;a.EVENT_MOUSEMOVE=8;a.EVENT_MOUSEMOVE_CURVE=9;a.EVENT_SCROLL=10;a.EVENT_SCROLL_CURVE=11;a.EVENT_MOUSEDOWN=12;a.EVENT_MOUSEUP=13;a.EVENT_KEYDOWN=14;a.EVENT_KEYUP=15;a.EVENT_CLICK=16;a.EVENT_FOCUS=17;a.EVENT_VALUECHANGE=18;a.EVENT_RESIZE=19;a.EVENT_DOMLOADED=20;a.EVENT_LOAD=21;a.EVENT_PLACEHOLDER_SIZE=22;a.EVENT_UNLOAD=23;a.EVENT_BLUR=24;a.EVENT_SET_FRAME_BASE=
25;a.EVENT_TOUCHSTART=32;a.EVENT_TOUCHEND=33;a.EVENT_TOUCHCANCEL=34;a.EVENT_TOUCHMOVE=35;a.EVENT_TOUCHMOVE_CURVE=36;a.EVENT_NAVIGATE=37;a.EVENT_PLAY=38;a.EVENT_PAUSE=39;a.EVENT_INNERWIDTH=40;a.EVENT_INNERWIDTH_CURVE=41;a.EVENT_LOG=48;a.EVENT_ERROR=49;a.EVENT_DBL_CLICK=50;a.EVENT_FORM_SUBMIT=51;a.EVENT_SYS_SETMETA=8192;a.EVENT_SYS_SETVAR=8193;a.EVENT_SYS_HIGHLIGHT=8194;a.EVENT_COOKED_LOAD="load";a.EVENT_COOKED_UNLOAD="unload";a.EVENT_COOKED_NAVIGATE="navigate";a.EVENT_COOKED_CLICK="click";a.EVENT_COOKED_FOCUS=
"focus";a.EVENT_COOKED_CHANGE="change";a.EVENT_COOKED_MOUSE_THRASH="thrash";a.isUserActionEvent=function(d){switch(d){case a.EVENT_MOUSEDOWN:case a.EVENT_MOUSEMOVE:case a.EVENT_MOUSEMOVE_CURVE:case a.EVENT_MOUSEUP:case a.EVENT_KEYDOWN:case a.EVENT_KEYUP:case a.EVENT_TOUCHSTART:case a.EVENT_TOUCHEND:case a.EVENT_TOUCHMOVE:case a.EVENT_TOUCHMOVE_CURVE:case a.EVENT_TOUCHCANCEL:case a.EVENT_CLICK:case a.EVENT_SCROLL:case a.EVENT_SCROLL_CURVE:case a.EVENT_NAVIGATE:return!0}return!1};a.MAX_LOGS_PER_PAGE=
1024})(d||(d={}));(function(a){var d;a.$entry=function(a){return a&&a.apply?function(){try{return a.apply(this,arguments)}catch(c){}}:a};a.log=function(f){a.isDebug()&&window.console&&console.log(f)};a.logFSError=function(a){};a.stringify=function(a){var c=Array.prototype.toJSON,g=String.prototype.toJSON;try{return d||(d=window.JSON),c&&delete Array.prototype.toJSON,g&&delete String.prototype.toJSON,void 0===a?'"undefined"':a&&a.constructor==Date?isNaN(a)?'"Invalid Date"':'"'+a.toUTCString()+'"':
d.stringify(a)}catch(b){return'"TypeError: JSON.stringify cannot serialize cyclic structures"'}finally{c&&(Array.prototype.toJSON=c),g&&(String.prototype.toJSON=g)}};a.parseJson=function(a){d||(d=window.JSON);return d.parse(a)}})(d||(d={}));(function(a){function d(a){var e={};if(!a)return e;if(a.classList)for(var k=0;k<a.classList.length;++k)e[a.classList[k]]=!0;else if(a.className)for(a=(null!=a.className.animVal?a.className.animVal:a.className).split(" "),k=0;k<a.length;++k)e[a[k].trim()]=!0;return e}
a.NYI_KIND="nyi";a.BLOCKED_KIND="blocked";a.HIDE_KIND="hide";var f=function(){function a(b,k){var c=this;this._parent=b;this._classes={};this._attrs={};for(var g=0,h=0,f=0,d=function(){if(0!=f-h)switch(g){case 0:c._tag=k.slice(h,f);break;case 1:c._id=k.slice(h+1,f);break;case 2:c._classes[k.slice(h+1,f)]=!0;break;case 3:var a=k.slice(h,f).slice(1).split("="),b=a[0].trim(),a=a[1].trim();if("]"!=a[a.length-1])throw"Unsupported selector";a=a.slice(0,a.length-1);if("'"==a[0]||'"'==a[0]){if(a[a.length-
1]!=a[0])throw"Unsupported selector";a=a.slice(1,a.length-1)}c._attrs[b]=a}},f=0;f<k.length;++f)switch(k[f]){case "#":d();g=1;h=f;break;case ".":d();g=2;h=f;break;case "[":d(),g=3,h=f}d()}a.prototype.parent=function(){return this._parent};a.prototype.serialize=function(){var a="";this._tag&&(a+=this._tag);this._id&&(a+="#"+this._id);for(var b in this._classes)a+="."+b;for(var c in this._attrs)a+="["+c+"="+this._attrs[c]+"]";return a};a.prototype.matches=function(a,b){if(!a||this._tag&&a.tagName.toLowerCase()!=
this._tag||this._id&&a.id!=this._id)return!1;for(var c in this._classes)if(!(c in b))return!1;for(var g in this._attrs)if(a.getAttribute(g)!=this._attrs[g])return!1;return this._parent?this._parent.matches(a.parentElement,d(a.parentElement)):!0};return a}();a.BlockRuleElem=f;var c=function(){function a(b){this.kind=b.Kind;b=b.Selector.split(">");for(var c=null,g=0;g<b.length;)var m=b[g++].trim(),c=new f(c,m);this.rules=c}a.prototype.serialize=function(){for(var a=null,b=this.rules;b;b=b.parent())a=
a?b.serialize()+">"+a:b.serialize();return a};return a}();a.BlockRule=c;var g=function(){function a(){this._rules=[];this.rawRules=[]}a.prototype.isBlocked=function(a){for(var b=d(a),c=0;c<this._rules.length;++c)if(this._rules[c].rules.matches(a,b))return this._rules[c].kind;return null};a.prototype.addRule=function(a){this.rawRules.push(a);this._rules.push(new c(a))};a.prototype.mungeBlockedStyle=function(a,b){var c=a.getBoundingClientRect(),g=Math.floor(c.width),c=Math.floor(c.height);if("object"==
a.tagName.toLowerCase())for(var h=a.children,f=0;f<h.length;f++){var d=h[f];if("embed"==d.tagName.toLowerCase()){h=d.getBoundingClientRect();g=Math.max(g,Math.floor(h.width));c=Math.max(c,Math.floor(h.height));break}}h="";null!=b&&(h=b.trim());0<h.length&&";"!=h.charAt(h.length-1)&&(h+=";");if(0!=g||0!=c)h+="width:"+g+"px;height:"+c+"px;";return h};return a}();a.Blocker=g})(d||(d={}));(function(a){a.Node_ELEMENT_NODE=1;a.Node_ATTRIBUTE_NODE=2;a.Node_TEXT_NODE=3;a.Node_CDATA_SECTION_NODE=4;a.Node_ENTITY_REFERENCE_NODE=
5;a.Node_ENTITY_NODE=6;a.Node_PROCESSING_INSTRUCTION_NODE=7;a.Node_COMMENT_NODE=8;a.Node_DOCUMENT_NODE=9;a.Node_DOCUMENT_TYPE_NODE=10;a.Node_DOCUMENT_FRAGMENT_NODE=11;a.Node_NOTATION_NODE=12;a.XHR_UNSENT=0;a.XHR_OPENED=1;a.XHR_HEADERS_RECEIVED=2;a.XHR_LOADING=3;a.XHR_DONE=4})(d||(d={}));(function(a){function d(a){return"_fsblocked"in a}function f(a,b){a._fsblocked=b}function c(a){return a?a._fs:null}function g(a){return(a=c(a))?a.id:0}function b(a,b){if(a.attributes&&0<a.attributes.length)for(var c=
0;c<a.attributes.length;c++){var g=a.attributes[c];b(g.name,g.value)}}a.isBlocked=d;a.blockKind=function(a){return a._fsblocked};a.setBlocked=f;a.mirrorFor=c;a.fsid=g;a.fsidIfNotBlocked=function(a){return d(a)?0:g(a)};var e=function(){function g(a,b){this._ctx=a;this._blocker=b;this._curId=1}g.prototype.curId=function(){return this._curId};g.prototype.tokenizeNode=function(a,b,g,e){var k=this._curId;try{var f=[],d=this.tokeNode(g,f,e);if(d&&a){var q=c(a),y=c(b);d.parent=q;y==q.child&&(q.child=d);
d.next=y;null==y?(d.prev=q.lastChild,q.lastChild=d):d.prev=y.prev;null!=d.prev&&(d.prev.next=d);null!=d.next&&(d.next.prev=d)}return f}catch(A){return this._curId=k,[]}};g.prototype.removeMirror=function(a){a.parent.child==a&&(a.parent.child=a.next);a.parent.lastChild==a&&(a.parent.lastChild=a.prev);a.prev&&(a.prev.next=a.next);a.next&&(a.next.prev=a.prev);a.id=0;a.child&&this.clearIds(a.child)};g.prototype.clearIds=function(a){a.id=0;a.next&&this.clearIds(a.next);a.child&&this.clearIds(a.child)};
g.prototype.tokeNode=function(c,g,e){if("SCRIPT"==c.nodeName||c.nodeType==a.Node_COMMENT_NODE)return null;var k={id:this._curId++,node:c};c._fs=k;var f=c.nodeName;"http://www.w3.org/2000/svg"==c.namespaceURI&&(f="svg:"+f);g.push("<"+f);try{if(this.processBlockedElem(c,g))return k;e&&e(c);b(c,function(a,b){g.push(":"+a);g.push(b)});if(c.firstChild){g.push("[");for(var f=null,d=c.firstChild;d;d=d.nextSibling){var q=this.tokeNode(d,g,e);q&&(q.parent=k,f?(f.next=q,q.prev=f):k.child=q,f=k.lastChild=q)}g.push("]")}c.nodeType==
a.Node_TEXT_NODE&&g.push(c.textContent)}catch(t){}return k};g.prototype.processBlockedElem=function(c,g){var e=this;if(c.nodeType==a.Node_ELEMENT_NODE&&this._blocker){var k=this._blocker.isBlocked(c);if(k){f(c,k);var d,q=!1;b(c,function(a,b){if("class"==a)b+=" _fs_block_"+k,d=!0;else if("style"==a)b=e._blocker.mungeBlockedStyle(c,b),q=!0;else if("value"==a||"checked"==a||"src"==a)return;g.push(":"+a);g.push(b)});d||(g.push(":class"),g.push("_fs_block_"+k));q||(g.push(":style"),g.push(this._blocker.mungeBlockedStyle(c,
"")));return!0}}return!1};return g}();a.NodeEncoder=e})(d||(d={}));(function(a){function d(a,c){var g=Object.getOwnPropertyDescriptor(a.prototype,c);Object.defineProperty(a.prototype,c,{set:function(a){var c=this;setTimeout(function(){b(c)},0);return g.set.call(this,a)},get:function(){return g.get.call(this)}})}function f(a){switch(a.type){case "checkbox":case "radio":return""+a.checked;default:return a.value}}var c=function(){function c(g,e){var d=this;this._onchange=g;this._checkElem=e;this._fallback=
!1;this._elems={};this._values={};b=function(b){var c=a.fsid(b);if(c&&(b=d._elems[c])){var g=f(b);g!=d._values[c]&&(d._onchange(b),d._values[c]=g)}}}c.prototype.hookEvents=function(){var a;(a=Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,"value"))&&a.set?(g||(d(HTMLInputElement,"value"),d(HTMLInputElement,"checked"),d(HTMLSelectElement,"value"),d(HTMLTextAreaElement,"value"),g=!0),a=!0):a=!1;a||(this._fallback=!0)};c.prototype.addInput=function(b){var c=a.fsid(b);this._elems[c]=b;this._values[c]=
f(b);this._values[c]&&this._onchange(b)};c.prototype.invokeGlobalOnChange=function(a){b(a)};c.prototype.tick=function(){if(this._fallback)for(var a in this._elems)if(this._checkElem(this._elems[a])){var b=this._elems[a],c=f(b);c!=this._values[a]&&(this._onchange(b),this._values[a]=c)}else delete this._elems[a],delete this._values[a]};c.prototype._usingFallback=function(){return this._fallback};c.prototype._trackingElem=function(a){return!!this._elems[a]};return c}();a.InputWatcher=c;var g=!1,b;a.valueOfInputishElem=
f})(d||(d={}));(function(a){var d=function(){function a(){this.dict={idx:-1,map:{}};this.startIdx=0}a.prototype.encode=function(a){function g(){e?1<f.length?k.push([e.idx,f.length]):k.push(e.idx):k.push(f[0])}if(0==a.length)return[];for(var b=a[0],e=Object.prototype.hasOwnProperty.call(this.dict.map,b)?this.dict.map[b]:null,k=[],d,f=[b],b=1;b<a.length;b++)if(d=a[b],e&&Object.prototype.hasOwnProperty.call(e.map,d))f.push(d),e=e.map[d];else{g();var h=this.startIdx+b-f.length;null==e&&(e={idx:h,map:{}},
this.dict.map[f[f.length-1]]=e);e.map[d]={idx:h,map:{}};f=[d];e=Object.prototype.hasOwnProperty.call(this.dict.map,d)?this.dict.map[d]:null}g();this.startIdx+=a.length;return k};return a}();a.LZJGWEncoder=d;d=function(){function a(){this._seq=[]}a.prototype.sequence=function(){return this._seq};a.prototype.decode=function(a){for(var g=this._seq.length,b=0;b<a.length;++b){var e=a[b];switch(typeof e){case "string":this._seq.push(e);break;case "number":this._seq.push(this._seq[e]);break;case "object":for(var k=
0;k<e[1];k++)this._seq.push(this._seq[e[0]+k])}}return g};return a}();a.LZJGWDecoder=d})(d||(d={}));(function(a){a.MUTATION_PROCESSING_INTERVAL=250;a.CURVE_SAMPLING_INTERVAL=142;a.UPLOAD_INTERVAL=5E3;a.USER_INACTIVITY_TIMEOUT=1E4;var d=function(){function a(c){this._interval=c;this._handle=-1}a.prototype.oneShot=function(a){setTimeout(a,this._interval)};a.prototype.start=function(a){-1==this._handle&&(this._handle=setInterval(a,this._interval))};a.prototype.stop=function(){-1!=this._handle&&(clearInterval(this._handle),
this._handle=-1)};return a}(),f=function(){function c(c,b,e,k,f,m,h,p){void 0===f&&(f=function(){});void 0===m&&(m=new d(a.CURVE_SAMPLING_INTERVAL));void 0===h&&(h=new d(a.MUTATION_PROCESSING_INTERVAL));void 0===p&&(p=new d(a.UPLOAD_INTERVAL));this._ctx=c;this._recUrlPrefix=b;this._processor=e;this._mutProvider=k;this._beforeProcessEvents=f;this._sampleCurvesTicker=m;this._processMutationsTicker=h;this._uploadTicker=p;this._eventQueue=[];this._outgoingEventQueue=[];this._bundleQueue=[];this._recordingDisabled=
!1;this._bundleSeq=1;this._lastWhenTime=this._lastPostTime=0;this._lastWhen=-1;this._lastUserAction=0;this._gotUnload=!1;this._lastBundleTime=c.wallTime()}c.prototype.rawQueue=function(){return this._eventQueue};c.prototype.startPipeline=function(){var a=this;this._recordingDisabled||this._pipelineStarted||(this._lastUserAction=this._ctx.now(),this.processEvents(),this._processMutationsTicker.start(function(){a.processEvents()}),this._sampleCurvesTicker.start(function(){a.processEvents(!0)}),this._ctx.amInsideIFrame()||
(this.enqueueAndSendBundle(),this._uploadTicker.start(function(){a.enqueueAndSendBundle()})),this._pipelineStarted=!0)};c.prototype.enqueue=function(a,b){this.enqueueAt(this._ctx.now(),a,b)};c.prototype.enqueueAt=function(c,b,e){this._recordingDisabled||(c<=this._lastWhen&&(c=this._lastWhen+1),this._lastWhen=c,this._eventQueue.push({When:c,Kind:b,Args:e}),a.isUserActionEvent(b)&&(this._lastUserAction=c))};c.prototype.disableRecording=function(){this._recordingDisabled=!0;this.stopPipeline()};c.prototype.addUnload=
function(){this._gotUnload||(this._gotUnload=!0,this.enqueue(a.EVENT_UNLOAD,[]),this.swanSong())};c.prototype.shutdown=function(){this._flush();this.addUnload();this._flush();this.disableRecording()};c.prototype._flush=function(){this.processEvents();this.maybeSendNextBundle()};c.prototype.prequeue=function(a,b){this._recordingDisabled||this._eventQueue.unshift({When:0,Kind:a,Args:b})};c.prototype.appendToOutgoingQueue=function(a){this._outgoingEventQueue=this._outgoingEventQueue.concat(a)};c.prototype.appendToQueue=
function(a){this._eventQueue=this._eventQueue.concat(a)};c.prototype.lastSentEventTime=function(){return this._lastWhenTime};c.prototype.swanSong=function(){if(!this._recordingDisabled&&!this._ctx.amInsideIFrame()&&(this.processEvents(),0<this._outgoingEventQueue.length&&this.enqueueNextBundle(),0<this._bundleQueue.length||this._pendingBundle)){var c=this._bundleQueue.concat();this._pendingBundle&&c.unshift(this._pendingBundle);a.log("Saving "+c.length+" bundles in swan-song.");c={UserId:this._ctx.userId(),
SessionId:this._ctx.sessionId(),PageId:this._ctx.pageId(),Bundles:c,PageStartTime:this._ctx.startTime(),LastBundleTime:this._lastBundleTime};try{localStorage.swanSong=a.stringify(c)}catch(b){}}};c.prototype.recoverSwanSong=function(){if(!this._ctx.amInsideIFrame())try{if("swanSong"in localStorage){var c=localStorage.swanSong;delete localStorage.swanSong;var b=a.parseJson(c);if(b.Bundles)if(b.Bundles&&b.UserId&&b.SessionId&&b.PageId)for(c=0;c<b.Bundles.length;++c){var e=null;0==c&&(e=this._ctx.wallTime()-
b.LastBundleTime);this.sendSwanSongBundle(b.UserId,b.SessionId,b.PageId,b.PageStartTime,b.Bundles[c],e)}else a.log("Malformed swan song found. Ignoring it.");else b.Bundle&&b.UserId&&b.SessionId&&b.PageId?this.sendSwanSongBundle(b.UserId,b.SessionId,b.PageId,b.PageStartTime||0,b.Bundle,b.LastBundleTime?this._ctx.wallTime()-b.LastBundleTime:null):a.log("Malformed swan song found. Ignoring it.")}}catch(k){a.log("Error recovering swan-song: "+k)}};c.prototype.sendSwanSongBundle=function(c,b,e,k,d,f){c=
this.bundleUrl(this._ctx.orgId(),c,b,e,d,k,f);this._ctx.post(c,d,function(b){a.log("Sent "+d.Evts.length+" trailing events from last session as Seq "+d.Seq)},function(){a.log("Failed to send events from last session")})};c.prototype.rebaseIframe=function(c,b){var e=this._ctx.baseUri();0<this._eventQueue.length?this._eventQueue.unshift({When:this._eventQueue[0].When,Kind:a.EVENT_SET_FRAME_BASE,Args:[e,b]}):this.enqueue(a.EVENT_SET_FRAME_BASE,[e,b]);for(var e=0,k=this._eventQueue.length;e<k;e++){var d=
this._eventQueue[e],f=d.When+this._ctx.startTime()-c;0>f&&(f=0);d.When=f}};c.prototype.processEvents=function(c){this._beforeProcessEvents();if((this._eventQueue.length||this._mutProvider.hasMutations())&&!(this._ctx.now()-this._lastUserAction>a.USER_INACTIVITY_TIMEOUT)&&null!=this._ctx.frameId()){var b=this._eventQueue;this._eventQueue=[];b=this._processor.processQueue(b);c||(b=b.concat(this._mutProvider.processMutations()));this.ensureFrameIds(b);this._ctx.amInsideIFrame()?parent.postMessage(a.FS_IFRAME_EVENTS+
a.FS_DELIMITER+a.stringify(b),"*"):void 0!==this._ctx.pageId()&&(this._outgoingEventQueue=this._outgoingEventQueue.concat(b))}};c.prototype.ensureFrameIds=function(a){var b=this._ctx.frameId();if(b)for(var c=this._ctx.parentIds(),k=c&&0<c.length,d=0;d<a.length;++d){var f=a[d];f.FId||(f.FId=b);k&&!f.PIds&&(f.PIds=c)}};c.prototype.enqueueAndSendBundle=function(){this._pendingBundle?this._pendingBundleFailed&&this._sendPendingBundle():0==this._outgoingEventQueue.length?this.maybeSendNextBundle():this.enqueueNextBundle()};
c.prototype.enqueueNextBundle=function(){var a={When:this._outgoingEventQueue[0].When,Seq:this._bundleSeq++,Evts:this._outgoingEventQueue};this._outgoingEventQueue=[];this._bundleQueue.push(a);this.maybeSendNextBundle()};c.prototype.maybeSendNextBundle=function(){this._ctx.pageId()&&(!this._pendingBundle&&0!=this._bundleQueue.length)&&(this._pendingBundle=this._bundleQueue.shift(),this._sendPendingBundle())};c.prototype.bundleUrl=function(a,b,c,k,d,f,h){a=this._recUrlPrefix+"/bundle?OrgId="+a+"&UserId="+
b+"&SessionId="+c+"&PageId="+k+"&Seq="+d.Seq;f&&(a+="&PageStartTime="+f);h&&(a+="&DeltaT="+h);return a};c.prototype._sendPendingBundle=function(){var c=this,b=this._pendingBundle;this._pendingBundleFailed=!1;var e=this._ctx.wallTime(),k=this.bundleUrl(this._ctx.orgId(),this._ctx.userId(),this._ctx.sessionId(),this._ctx.pageId(),b);this._lastPostTime=this._lastBundleTime=e;this._lastWhenTime=b.Evts[b.Evts.length-1].When;this._ctx.post(k,b,function(e){a.log("Sent bundle "+b.Seq+" with "+b.Evts.length+
" events");c._pendingBundle=null;c._ctx.wallTime()-c._lastPostTime>a.UPLOAD_INTERVAL&&c.maybeSendNextBundle()},function(b){a.log("Failed to send events.");c._pendingBundleFailed=!0;404==b?c._uploadTicker.stop():202==b&&c._uploadTicker.stop()})};c.prototype.stopPipeline=function(){this._pipelineStarted&&(this._sampleCurvesTicker.stop(),this._processMutationsTicker.stop(),this._uploadTicker.stop())};return c}();a.EventQueue=f})(d||(d={}));(function(a){var d=function(){function d(c,g,b){void 0===b&&
(b=function(a,b){});this._ctx=c;this._blocker=g;this._visitor=b;this._sentDomSnapshot=!1;this._records=[];this._lz=new a.LZJGWEncoder;this._encoder=new a.NodeEncoder(c,g)}d.prototype.hasMutations=function(){return!this._sentDomSnapshot||0<this._records.length};d.prototype.hookMutations=function(a){var g=this;void 0===a&&(a=document.documentElement);this._root=a;this._sentDomSnapshot=!1;(new window.MutationObserver(function(a){g._records=g._records.concat(a)})).observe(a,{childList:!0,attributes:!0,
characterData:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0})};d.prototype.processMutations=function(){var c=this._ctx.now(),g=[];this._sentDomSnapshot||(this.genInsert(c,g,null,this._root,null),this._sentDomSnapshot=!0);if(0==this._records.length)return g;var b={},e={};this.processRecords(c,g,e,b);for(var d in e){var f=d.split(":");g.push({Kind:a.EVENT_MUT_ATTR,When:c,Args:[parseInt(f[0]),f[1],e[d]]})}for(d in b)g.push({Kind:a.EVENT_MUT_TEXT,When:c,Args:[parseInt(d),b[d]]});this._records=
[];return g};d.prototype.processRecords=function(c,g,b,e){for(var d={},f={},m=0;m<this._records.length;++m)try{var h=this._records[m],p=a.fsid(h.target);if(p)switch(d[p]=h.target,h.type){case "childList":if(0<h.removedNodes.length)for(var q=0;q<h.removedNodes.length;++q){var r=a.mirrorFor(h.removedNodes[q]);r&&r.id&&r.parent==a.mirrorFor(h.target)&&r.next==a.mirrorFor(h.nextSibling)&&this.genRemove(c,g,r)}p&&(f[p]=h.target);break;case "characterData":var u=h.target.textContent;h.oldValue!=u&&(a.isBlocked(h.target)||
(e[p]=u));break;case "attributes":var t=h.attributeName;h.target.hasAttribute(t)?(u=h.target.getAttribute(t),h.oldValue!=u&&(u=this.rewriteAttr(h.target,t,u),null!==u&&(b[p+":"+t]=u))):b[p+":"+t]=null}}catch(y){}for(var A in f)b=f[A],(e=a.mirrorFor(b))&&e.id&&this.diff(c,g,b,e.child,b.firstChild);for(A in d)b=d[A],this.maybeAddPlaceholderResize(c,g,b)};d.prototype.diff=function(c,g,b,e,d){for(;e&&d;){var f=a.mirrorFor(d);a.fsid(d)?e.id==f.id?(e=e.next,d=d.nextSibling):(this.genRemove(c,g,e),e=e.next):
(this.genInsert(c,g,b,d,e.node),d=d.nextSibling)}for(;e;e=e.next)this.genRemove(c,g,e);for(;d;d=d.nextSibling)this.genInsert(c,g,b,d,null)};d.prototype.maybeAddPlaceholderResize=function(c,d,b){try{for(;b&&!a.fsid(b);)b=b.parentNode;if(b&&a.isBlocked(b)){var e=b.getBoundingClientRect(),f=Math.floor(e.width),l=Math.floor(e.height);d.push({When:c,Kind:a.EVENT_PLACEHOLDER_SIZE,Args:[a.fsid(b),f,l]})}}catch(m){}};d.prototype.genInsert=function(c,d,b,e,f){var l=this;if(b&&a.isBlocked(b))return null;e=
this._encoder.tokenizeNode(b,f,e,function(a){l._visitor(c,a)});0<e.length&&d.push({When:c,Kind:a.EVENT_MUT_INSERT,Args:[a.fsid(b)||-1,a.fsid(f)||-1,this._lz.encode(e)]})};d.prototype.genRemove=function(c,d,b){var e=b.id;this._encoder.removeMirror(b);if(0<d.length&&(b=d[d.length-1],b.Kind==a.EVENT_MUT_REMOVE)){b.Args.push(e);return}d.push({When:c,Kind:a.EVENT_MUT_REMOVE,Args:[e]})};d.prototype.rewriteAttr=function(c,d,b){switch(d){case "style":a.isBlocked(c)&&(b=this._blocker.mungeBlockedStyle(c,b));
break;case "class":a.isBlocked(c)&&0>b.indexOf("_fs_block_")&&(c=a.blockKind(c),b+=" _fs_block_"+c);break;case "value":a.isBlocked(c)&&(b=null)}return b};return d}();a.MutationHandler=d})(d||(d={}));(function(a){var d=function(){function a(c,b,d){this._ctx=c;this._q=b;this._valueIndices=d;this._evts=[]}a.prototype.add=function(a){0==this._evts.length&&this._q.push(a);this._evts.push(a)};a.prototype.finish=function(a,b){var c=this._evts.length;if(1>=c)return!1;for(var d=this._evts[0].When,f=this._evts[c-
1].When,m=0;m<this._valueIndices.length;++m){var h=this._valueIndices[m],p=this._evts[0].Args[h],q=(this._evts[1].When-d)/(f-d),r=(this._evts[1].Args[h]-p)/q,u=this._evts[c-1].Args[h],q=(f-this._evts[c-2].When)/(f-d);b.push(p,u,r,(u-this._evts[c-2].Args[h])/q)}this._evts[0].Kind=a;this._evts[0].Args=b;return!0};a.prototype.evts=function(){return this._evts};return a}(),f=function(){function c(a,b){this._ctx=a;this._blocker=b;this._gotInitialScroll=!1}c.prototype.processQueue=function(c){if(0==c.length)return c;
this.maybeAddInitialScroll();for(var b=this._ctx.now(),e=[],f=new d(this._ctx,e,[0,1]),l={},m={},h,p=0;p<c.length;++p){var v=c[p];switch(v.Kind){case a.EVENT_MOUSEMOVE:f.add(v);break;case a.EVENT_TOUCHMOVE:var r=v.Args[0];r in l||(l[r]=new d(this._ctx,e,[1,2]));l[r].add(v);break;case a.EVENT_SCROLL:r=v.Args[0];r in m||(m[r]=new d(this._ctx,e,[1,2]));m[r].add(v);break;case a.EVENT_INNERWIDTH:h||(h=new d(this._ctx,e,[0]));h.add(v);break;default:e.push(v)}}f.finish(a.EVENT_MOUSEMOVE_CURVE,[b])&&(c=f.evts(),
f=c[c.length-1].Args,2<f.length&&f[2]&&c[0].Args.push(f[2]));for(r in m)c=parseInt(r),m[c].finish(a.EVENT_SCROLL_CURVE,[b,c]);for(r in l)c=parseInt(r),l[c].finish(a.EVENT_TOUCHMOVE_CURVE,[b,c]);h&&h.finish(a.EVENT_INNERWIDTH_CURVE,[b]);return e};c.prototype.maybeAddInitialScroll=function(){!this._gotInitialScroll&&(document.body&&a.fsid(document.body))&&(this._ctx.addWindowScroll(),this._gotInitialScroll=!0)};return c}();a.EventProcessor=f})(d||(d={}));(function(a){var d=function(){function d(a){this._queue=
a;this._overflow=this._enabled=!1;this._total=0}d.prototype.enable=function(){var c=this;c._enabled||(c._enabled=!0,window.console?(console.log&&console.log.apply&&(c._oldLog=console.log,console.log=a.$entry(function(){c.addLog("log",arguments);return c._oldLog.apply(this,arguments)})),console.info&&console.info.apply&&(c._oldInfo=console.info,console.info=a.$entry(function(){c.addLog("info",arguments);return c._oldInfo.apply(this,arguments)})),console.warn&&console.warn.apply&&(c._oldWarn=console.warn,
console.warn=a.$entry(function(){c.addLog("warn",arguments);return c._oldWarn.apply(this,arguments)})),console.error&&console.error.apply&&(c._oldError=console.error,console.error=a.$entry(function(){c.addLog("error",arguments);return c._oldError.apply(this,arguments)}))):c.addLog("log",["NOTE: Log messages cannot be captured on IE9"]),c._oldOnError=window.onerror,window.onerror=function(a,b,d){c.addError(a,b,d);if(c._oldOnError)return c._oldOnError.apply(this,arguments)})};d.prototype.disable=function(){this._enabled&&
(this._enabled=!1,this._oldLog&&(console.log=this._oldLog),this._oldInfo&&(console.info=this._oldInfo),this._oldWarn&&(console.warn=this._oldWarn),this._oldError&&(console.error=this._oldError),window.onerror=this._oldOnError)};d.prototype.addLog=function(c,d){if(this.checkOverflow()){for(var b=[c],e=0;e<d.length;++e)b.push(a.stringify(d[e]));this._queue.enqueue(a.EVENT_LOG,b)}};d.prototype.addError=function(c,d,b){this.checkOverflow()&&this._queue.enqueue(a.EVENT_ERROR,[c,d,b])};d.prototype.checkOverflow=
function(){if(this._overflow)return!1;if(this._total==a.MAX_LOGS_PER_PAGE)return this._queue.enqueue(a.EVENT_LOG,["warn",d.OVERFLOW_MSG]),this._overflow=!0,!1;this._total++;return!0};d.OVERFLOW_MSG='"[received more than '+a.MAX_LOGS_PER_PAGE+' messages; no longer recording console]"';return d}();a.ConsoleHook=d})(d||(d={}));(function(a){a.UID_COOKIE="fs_uid";var d=function(){function d(c,g){this._host=c;this._orgId=g;this._appKey=this._sessionId=this._userId="";this._poisoned=!1;this._cookies={};
for(var b=document.cookie.split(";"),e=0;e<b.length;e++){var f=b[e].replace(/^\s+|\s+$/g,"").split("=");this._cookies[f[0]]=f[1]}if(b=this._cookies[a.UID_COOKIE])b=b.split("`"),3>b.length?this._userId=this._cookies[a.UID_COOKIE]:b[0]==this._host&&b[1]==this._orgId&&(this._userId=b[2],5<=b.length&&(this._appKey=decodeURIComponent(b[3]),this._poisoned="true"==b[4]));b=this._userId.indexOf(":");-1!=b&&(this._sessionId=this._userId.slice(b+1),this._userId=this._userId.slice(0,b))}d.prototype.host=function(){return this._host};
d.prototype.orgId=function(){return this._orgId};d.prototype.userId=function(){return this._userId};d.prototype.sessionId=function(){return this._sessionId};d.prototype.appKey=function(){return this._appKey};d.prototype.poisoned=function(){return this._poisoned};d.prototype.cookies=function(){return this._cookies};d.prototype.setCookie=function(a,d){var b=a+"="+d,b=this._domain?b+("; domain=."+encodeURIComponent(this._domain)):b+"; domain=";document.cookie=b+"; expires=Fri, 31 Dec 9999 23:59:59 GMT; path=/"};
d.prototype.setIds=function(a,d,b){if("localhost"==a||"127.0.0.1"==a)a="";this._domain=a;this._userId=d;this._sessionId=b;this.write()};d.prototype.setAppId=function(c){if(!c)return this._poisoned?(a.log("blocking FS.setUserVars API call due to mismatched user ID"),!1):!0;if(this._appKey&&this._appKey!=c)return a.log("blocking FS.identify API call; existing uid ("+this._appKey+") does not match provided uid ("+c+")"),this._poisoned=!0,this.write(),!1;this._appKey=c;this._poisoned=!1;this.write();
return!0};d.prototype.write=function(){if(null!=this._domain){var c=this._host+"`"+this._orgId+"`"+this._userId+":"+this._sessionId;this._appKey&&(c+="`"+encodeURIComponent(this._appKey)+"`"+this._poisoned);this.setCookie(a.UID_COOKIE,c)}};return d}();a.Identity=d})(d||(d={}));(function(a){var d=function(){function d(c,g){var b=this;this._queue=c;this._identity=g;this.AccountSystemVars={acctId:"str",displayName:"str",website:"str"};this.UserSystemVars={uid:"str",displayName:"str",email:"str"};this.VarTypes=
{str:function(a){return"string"==typeof a},bool:function(a){return"boolean"==typeof a},"int":function(a){return"number"==typeof a&&0==a-Math.floor(a)},real:function(a){return"number"==typeof a},date:function(a){return a?!isNaN(a.constructor===Date?a:new Date(a)):!1}};this._apiImpl=a.$entry(function(c,d){switch(c){case "account":if(b._identity.poisoned()){a.log("blocking FS.identifyAccount API call due to mismatched user ID");break}b.setvar_api("acct",b.AccountSystemVars,d);break;case "user":if(!b._identity.setAppId(d.uid))break;
b.setvar_api("user",b.UserSystemVars,d);break;default:a.log('invalid operation "'+c+'"; only "account" and "user" are supported at present')}})}d.prototype.api=function(a,d){this._apiImpl(a,d)};d.prototype.processApiQueue=function(a){if(a)for(var d=0;d<a.length;d++)this.api(a[d][0],a[d][1])};d.prototype.setvar_api=function(c,d,b){var e={},f;for(f in b)if(b.hasOwnProperty(f)){var l=b[f];a.log("set-var('"+c+"'): \""+f+'" = '+a.stringify(l));var m=typeof l;if("object"!==m||l&&l.constructor==Date){var h,
p;if(f in d)h=f,p=d[f];else{p=f.split("_");if(2!=p.length){a.log('variables must be of the form "name_type", where "type" is one of [str, bool, int, real, date]');this._queue.enqueue(a.EVENT_SYS_HIGHLIGHT,["badvarname",c+":"+f]);continue}-1!=f.indexOf(" ")?(h=f.replace(/ /g,""),this._queue.enqueue(a.EVENT_SYS_HIGHLIGHT,["badvarname",c+":"+f]),a.log("Warning: variable '"+f+"' has spaces in it, which is disallowed. Converted name to '"+h+"'.")):h=f;p=p[1]}p in this.VarTypes?this.VarTypes[p](l)?("str"==
p&&(l=(l=/\b.*\b/g.exec(l))?l[0]:""),"date"==p&&(l=this.toIsoString(l)),e[h]=l):(a.log("illegal value "+a.stringify(l)+" for type "+p),"number"===m?m=0==l-Math.floor(l)?"integer":"real":"object"==m&&(null!=l&&l.constructor==Date)&&(m=isNaN(l)?"invalid date":"date"),this._queue.enqueue(a.EVENT_SYS_HIGHLIGHT,["badvartype",c+":"+f,m])):(a.log('invalid type "'+p+'"'),this._queue.enqueue(a.EVENT_SYS_HIGHLIGHT,["badvarname",c+":"+f]))}else l instanceof Array&&(m="array"),this._queue.enqueue(a.EVENT_SYS_HIGHLIGHT,
["badvartype",c+":"+f,m+" (unsupported)"])}this._queue.enqueue(a.EVENT_SYS_SETVAR,[c,a.stringify(e)])};d.prototype.toIsoString=function(a){return(a.constructor===Date?a:new Date(a)).toISOString()};return d}();a.Vars=d})(d||(d={}));(function(a){function d(b,c,e,f){void 0===f&&(f=null);b="//"+s.host()+b;var g=null;null!=c&&(g=a.stringify(c),M+=g.length,a.log("total bytes written: "+M));var h=new XMLHttpRequest;if("withCredentials"in h)h.onreadystatechange=function(){h.readyState==a.XHR_DONE&&(200==
h.status?e(h.responseText):f(h.status))},h.open("POST",G+b,!0),h.withCredentials=!0,h.setRequestHeader("Content-Type","text/plain"),h.send(g);else{var k=new XDomainRequest;k.onload=function(){e(k.responseText)};k.onerror=function(){f("Not Found"==k.responseText?404:500)};k.onprogress=function(){};k.open("POST",b);k.send(g)}}function f(){if("baseURI"in document)return document.baseURI;var a=document.getElementsByTagName("base")[0];return a&&a.href?a.href:location.href}function c(a){(a=a.target.tagName)&&
(a=a.toLowerCase());return a}function g(a,b){return a.tagName&&a.tagName.toLowerCase()in b?!0:a.parentNode?g(a.parentNode,b):!1}function b(a,b){if(void 0!==a.changedTouches)for(var c=0;c<a.changedTouches.length;++c){var d=a.changedTouches[c];isNaN(parseInt(d.identifier))&&(d.identifier=0);n.enqueue(b,[d.identifier,d.clientX,d.clientY])}}function e(){var a=document.activeElement;a&&H.invokeGlobalOnChange(a)}function k(){var b=window.innerWidth;b!=W&&(n.enqueue(a.EVENT_INNERWIDTH,[b]),W=b)}function l(a,
b){a in N||(N[a]=setTimeout(function(){delete N[a];b()},ka))}function m(){var b=a.fsid(document.body);b&&l(b,function(){var c,d;"pageXOffset"in window?(c=window.pageXOffset,d=window.pageYOffset):(c=document.body.scrollLeft,d=document.body.scrollTop);if(c!=X||d!=Y)n.enqueue(a.EVENT_SCROLL,[b,c,d]),X=c,Y=d;k()})}function h(b){var c=b.target,d=a.fsid(c);d&&l(d,function(){n.enqueue(a.EVENT_SCROLL,[d,c.scrollLeft,c.scrollTop])})}function p(){Z?n.enqueue(a.EVENT_RESIZE,[document.body.clientWidth,document.body.clientHeight]):
n.enqueue(a.EVENT_RESIZE,[document.documentElement.clientWidth,document.documentElement.clientHeight])}function v(){var b=location.href;O!=b&&(O=b,n.enqueue(a.EVENT_NAVIGATE,[location.href,document.title]))}function r(b){var c=a.fsidIfNotBlocked(b);c&&n.enqueue(a.EVENT_VALUECHANGE,[c,a.valueOfInputishElem(b)])}function u(b){s.setIds(b.CookieDomain,b.UserIntId,b.SessionIntId);P=b.PageIntId;$=b.EmbedToken;a.log("/User,"+s.userId()+"/Session,"+s.sessionId()+"/Page,"+P)}function t(a){if(I&&a){var b=document.createElement("script");
b.text=a;b.async=!0;document.head.appendChild(b)}}function y(){var a=document.doctype;if(!a)return null;var b;b="<!DOCTYPE "+a.name;a.publicId&&(b+=' PUBLIC "'+a.publicId+'"');a.systemId&&(b+=' "'+a.systemId+'"');return b+">"}function A(){var b=document.documentElement,c=window._fs_hash,e=window._fs_replay_flags;O=location.href;if(J)b={OrgId:s.orgId(),UserId:s.userId(),Url:location.href,Base:f(),ScreenWidth:window.screen.width,ScreenHeight:window.screen.height,Width:b.clientWidth,Height:b.clientHeight,
Referrer:document.referrer,Doctype:y(),Hash:c},e&&(b.ReplayFlags=e),d(Q+"/page",b,function(b){try{var c=a.parseJson(b)}catch(d){z();return}b=c;u(b);R=b.IntegrationScript;t(b.IntegrationScript);if(window._fs_ready)try{window._fs_ready()}catch(e){a.log("exception in _fs_ready(): "+e)}for(b=0;b<c.Blocks.length;++b)try{x.addRule(c.Blocks[b])}catch(f){a.log("Unexpected error parsing block rule. Skipping "+c.Blocks[b])}n.startPipeline()},function(a){z()});else{a.log("Unable to record playback stream.");
var g=document.createElement("script");window.__fs_startResponse=function(a){u(a);R=a.IntegrationScript;t(a.IntegrationScript);document.body.removeChild(g)};g.src="//"+s.host()+Q+"/page?OrgId="+s.orgId()+"&UserId="+s.userId()+"&Url="+encodeURIComponent(location.href)+"&Base="+encodeURIComponent(f())+"&ScreenWidth="+window.screen.width+"&ScreenHeight="+window.screen.height+"&Width="+b.clientWidth+"&Height="+b.clientHeight+"&Referrer="+encodeURIComponent(document.referrer)+"&Doctype="+encodeURIComponent(y())+
"&Fallback=true"+(e?"&ReplayFlags="+e:"")+(c?"&Hash="+c:"");document.body.appendChild(g)}}function z(){n.disableRecording();aa();a.log("Disabling FS.");if(window._fs_ready)try{window._fs_ready(!0)}catch(b){a.log("exception in _fs_ready(): "+b)}}function ha(){ba.hookMutations();document.documentElement.addEventListener("scroll",function(a){h(a)},!0);window.addEventListener("mousemove",function(b){b=a.fsid(b.target)?[b.clientX,b.clientY,a.fsid(b.target)]:[b.clientX,b.clientY];n.enqueue(a.EVENT_MOUSEMOVE,
b)},!0);window.addEventListener("mousedown",function(b){n.enqueue(a.EVENT_MOUSEDOWN,[b.clientX,b.clientY]);!g(b.target,{button:!0,a:!0,input:!0})||"input"==c(b)&&"submit"!=b.target.type||n.swanSong()},!0);window.addEventListener("mouseup",function(b){n.enqueue(a.EVENT_MOUSEUP,[b.clientX,b.clientY])},!0);window.addEventListener("keydown",function(b){var d=document.activeElement;if(!d||a.fsidIfNotBlocked(d))e(),n.enqueue(a.EVENT_KEYDOWN,[b.keyCode]);switch(c(b)){case "button":13!=b.keyCode&&32!=b.keyCode||
n.swanSong();break;case "a":13==b.keyCode&&n.swanSong();break;case "input":"submit"==b.target.type&&13==b.keyCode&&n.swanSong()}},!0);window.addEventListener("keyup",function(b){var c=document.activeElement;if(!c||a.fsidIfNotBlocked(c))e(),n.enqueue(a.EVENT_KEYUP,[b.keyCode])},!0);window.addEventListener("scroll",function(a){m()});window.addEventListener("resize",function(a){p()});window.addEventListener("submit",function(b){(b=a.fsid(b.target))&&n.enqueue(a.EVENT_FORM_SUBMIT,[b])});document.body.addEventListener("click",
function(b){(b=a.fsid(b.target))&&n.enqueue(a.EVENT_CLICK,[b])},!0);document.body.addEventListener("dblclick",function(b){(b=a.fsid(b.target))&&n.enqueue(a.EVENT_DBL_CLICK,[b])},!0);document.body.addEventListener("focus",function(b){(b=a.fsid(b.target))&&n.enqueue(a.EVENT_FOCUS,[b])},!0);document.body.addEventListener("blur",function(b){(b=a.fsid(b.target))&&n.enqueue(a.EVENT_BLUR,[b])},!0);document.body.addEventListener("change",function(a){r(a.target)},!0);window.addEventListener("touchstart",function(c){b(c,
a.EVENT_TOUCHSTART);m()},!0);window.addEventListener("touchend",function(c){b(c,a.EVENT_TOUCHEND);m()},!0);window.addEventListener("touchmove",function(c){b(c,a.EVENT_TOUCHMOVE);m()},!0);window.addEventListener("touchcancel",function(c){b(c,a.EVENT_TOUCHCANCEL)},!0);window.addEventListener("play",function(b){var c=a.EVENT_PLAY;(b=a.fsid(b.target))&&n.enqueue(c,[b])},!0);window.addEventListener("pause",function(b){var c=a.EVENT_PAUSE;(b=a.fsid(b.target))&&n.enqueue(c,[b])},!0);H.hookEvents();if(history.pushState){window.addEventListener("popstate",
function(){v()});var d=history.pushState;history.pushState=function(a,b,c){d.call(this,a,b,c);v()};var f=history.replaceState;history.replaceState=function(a,b,c){f.call(this,a,b,c);v()}}}function U(){ca.enable()}function D(){return(new Date).getTime()}function B(){return window!=top&&!da}function ja(){var b=function(){I||(I=!0,n.enqueue(a.EVENT_DOMLOADED,[]),ha(),p(),t(R))},c=!1,d=function(){c||(c=!0,n.enqueue(a.EVENT_LOAD,[]))};switch(document.readyState){case "interactive":document.attachEvent||
b();break;case "complete":b(),d()}I||document.addEventListener("DOMContentLoaded",function(a){b()});c||window.addEventListener("load",function(a){b();d()});B()||(window.addEventListener("beforeunload",function(a){n.addUnload()}),window.addEventListener("unload",function(a){n.addUnload()}))}function V(){return s.userId()?s.userId()+":"+s.sessionId():null}function ia(){window.addEventListener("message",function(b){if("string"==typeof b.data&&0==b.data.indexOf(a.FS_MESSAGE_PREFIX)){var c=b.data.split(a.FS_DELIMITER);
if(c[0]==a.FS_SET_FRAME_ID_CMD)try{var d=parseInt(c[1]),e=a.parseJson(c[2]),f=parseInt(c[3]);var g=a.parseJson(c[4]);if(d)if(w)a.log("frame Id is already set to "+w+". Received second request to set it to "+d+" Iframe:"+location.href);else{a.log("FrameId received within frame "+location.href+": "+d);w=d;K=e;for(c=0;c<g.length;++c)x.addRule(g[c]);n.rebaseIframe(f,y());E=f;n.startPipeline();if(0<F.length){for(c=0;c<F.length;c++)F[c]();F=[]}}else a.log("Outer page gave us a bogus frame Id! Iframe: "+
location.href)}catch(h){a.log("Failed to parse frameId from message"+b.data)}else c[0]==a.FS_DISABLE_RECORDING?(n.disableRecording(),aa()):b.source==parent&&a.log("Invalid _fs postmessage command: "+c[0])}});w||(0==w?a.log("For some reason the outer window attempted to request a frameId"):(a.log("Asking for a frame ID from within frame: "+location.href),parent.postMessage(a.FS_REQUEST_FRAME_ID+a.FS_DELIMITER,"*")))}function aa(){for(var b=0;b<C.length;b++){var c=C[b];c.contentWindow&&c.contentWindow.postMessage&&
c.contentWindow.postMessage(a.FS_DISABLE_RECORDING,"*")}}function la(){window.addEventListener("message",function(b){if("string"==typeof b.data&&0==b.data.indexOf(a.FS_MESSAGE_PREFIX)){var c=b.data.split(a.FS_DELIMITER);if(c[0]==a.FS_IFRAME_EVENTS)b=a.parseJson(c[1]),0<b.length&&(B()?n.appendToQueue(b):n.appendToOutgoingQueue(b));else{var d;a:{d=b.source;for(var e=0;e<C.length;e++)if(C[e].contentWindow==d){d=a.fsid(C[e]);break a}a.log("Unable to locate frame for window");d=NaN}c[0]==a.FS_REQUEST_FRAME_ID?
b.source&&d?(a.log("Responding to FID request for frame "+d),ea(b.source,d)):a.log("No FrameId found. Hoping to send one later."):B()||a.log("Invalid _fs postmessage command: "+c[0]+" sent from child FrameId: "+d)}}})}function ea(b,c){var d=function(){var d=a.stringify(x.rawRules),e=[];0!=w&&(e=K?K.concat(w):[w]);b.postMessage(a.FS_SET_FRAME_ID_CMD+a.FS_DELIMITER+c+a.FS_DELIMITER+a.stringify(e)+a.FS_DELIMITER+E+a.FS_DELIMITER+d,"*")};null==w?F.push(d):d()}function fa(b){a.log("Injecting into Frame ["+
b.src+"]");try{if(b.src&&("about:blank"!=b.src&&0>b.src.indexOf("javascript:"))&&b.src!=b.contentWindow.location.href)a.log("Frame not yet loaded: "+b.src);else if(b.contentWindow.FS)a.log("FS already defined in Frame contentWindow: "+b.src+". Ignoring.");else{var c=b.contentDocument,d="var _fs_org='"+s.orgId()+"', _fs_host='"+s.host()+"', _fs_run_in_iframe=true, _fs_debug="+L+"; (function(w,a,t){a=w.createElement('script');a.async=1;a.src='"+G+"//'+_fs_host+'/s/fs.js';w.head.appendChild(a)})(document);",
e=c.createElement("script");e.textContent=d;c.head.appendChild(e)}}catch(f){a.log("iFrame no injecty. Probably not same origin.")}}function ma(b,c){C.push(c);na(c)?(a.log("Attempting to setup Frame ["+c.src+"]"),fa(c),c.addEventListener("load",function(b){a.log("onload for frame ["+c.src+"]");fa(c)})):(a.log("Frame Doesn't need injecting. Probably cross domain ["+c.src+"]"),c.contentWindow.postMessage&&(a.log("Eagerly sending FrameId "+b+" to Frame ["+c.src+"]"),ea(c.contentWindow,b)))}function na(a){var b=
a.src;return!a.hasAttribute("src")||"about:blank"==b||0==b.indexOf("javascript:")||0==b.indexOf(oa)}var ka=a.MUTATION_PROCESSING_INTERVAL/5,L=!1,M=0,P,w,K,oa=window.location.protocol+"//"+window.location.host,da,J,E=D(),O,I=!1,R=null,ga,X=-1,Y=-1,W=0,N={},$,Z=!1,G="https:",S={startTime:function(){return E},now:function(){return D()-E},wallTime:D,orgId:function(){return s.orgId()},userId:function(){return s.userId()},sessionId:function(){return s.sessionId()},pageId:function(){return P},baseUri:f,
amInsideIFrame:B,frameId:function(){return w},parentIds:function(){return K},post:d,addWindowScroll:m},Q=0>D()%1E3?"/recvm":"/rec",x=new a.Blocker,H=new a.InputWatcher(function(a){r(a)},function(b){return!!a.fsid(b)}),ba=new a.MutationHandler(S,x,function(b,c){switch(c.nodeName){case "INPUT":case "TEXTAREA":case "SELECT":H.addInput(c);break;case "FRAME":case "IFRAME":var d=a.fsid(c);if(!d){a.log("fsid missing or invalid for iFrame."+c.src);break}ga||(la(),ga=!0);ma(d,c);break;case "VIDEO":case "AUDIO":c.paused||
(d=a.fsid(c),n.enqueue(a.EVENT_PLAY,[d]))}}),pa=new a.EventProcessor(S,x),n=new a.EventQueue(S,Q,pa,ba,function(){H.tick();k()}),ca=new a.ConsoleHook(n),s,T;window._fs_shutdown=function(a){n.shutdown();a&&(a=document.getElementById(a))&&a.setAttribute("_fs_embed_token",$)};a.enableConsole=U;a.disableConsole=function(){ca.disable()};a._init=function(){if("_fs_host"in window||"_fs_ext_host"in window)if("_fs_org"in window||"_fs_ext_org"in window){"_fs_ext_debug"in window?L=!!window._fs_ext_debug:"_fs_debug"in
window&&(L=!!window._fs_debug);var b=window._fs_ext_host||window._fs_host,c=window._fs_ext_org||window._fs_org;a.log("host: "+b);a.log("orgid: "+c);s=new a.Identity(b,c);T=new a.Vars(n,s);0==b.indexOf("localhost")&&(G="");Z="BackCompat"==document.compatMode;da=!!window._fs_is_outer_script;w=B()?null:0;J=!!window.MutationEvent;B()?window._fs_run_in_iframe?parent.postMessage?ia():(J=!1,a.log("postMessage not supported")):a.log("Fullstory recording for this page is NOT allowed within an iFrame."):(x.addRule({Selector:"object",
Kind:a.NYI_KIND}),x.addRule({Selector:"embed",Kind:a.NYI_KIND}),x.addRule({Selector:"canvas",Kind:a.NYI_KIND}),x.addRule({Selector:"noscript",Kind:a.BLOCKED_KIND}),x.addRule({Selector:".fs-hide",Kind:a.HIDE_KIND}),T.processApiQueue(window.FS.q),delete window.FS.q,A())}else a.log("Missing global _fs_org. Recording disabled.");else a.log("Missing global _fs_host. Recording disabled.")};a._record=function(){J&&(n.recoverSwanSong(),E=D(),ja(),U())};a.isDebug=function(){return L};a._api=function(a,b){T.api(a,
b)};a.setUid=function(b,c,d){b&&"string"==typeof b?c&&"string"!=typeof c?a.log("setUid(): second argument (display name) must be a string"):(c||(c=b),d&&"object"!=typeof d?a.log('setUid(): third argument (metadata) must be of the form {name0: "value0", name1: "value1", ...}'):(d=d?a.stringify(d):"",a.log("setting uid: "+b+", meta: "+d),n.enqueue(a.EVENT_SYS_SETMETA,[b,c,d]))):a.log("setUid(): first argument (user id) is required and must be a string")};a.getCurrentSessionURL=function(){var a=V();
return a?G+"//"+s.host()+"/ui/"+s.orgId()+"/session/"+a:null};a.getCurrentSession=V;a._cookies=function(){return s.cookies()};a._setCookie=function(a,b){return s.setCookie(a,b)};a.FS_MESSAGE_PREFIX="_fs";a.FS_DELIMITER="{\uffff}";a.FS_REQUEST_FRAME_ID=a.FS_MESSAGE_PREFIX+"RequestFrameId";a.FS_SET_FRAME_ID_CMD=a.FS_MESSAGE_PREFIX+"SetFrameId";a.FS_IFRAME_EVENTS=a.FS_MESSAGE_PREFIX+"EvtBundle";a.FS_DISABLE_RECORDING=a.FS_MESSAGE_PREFIX+"DisableRecording";var C=[],F=[]})(d||(d={}));try{"FS"in window||
(window.FS={}),"_fs_loaded"in window||(window._fs_loaded=!0,window.FS.setUid=d.$entry(d.setUid),window.FS.getCurrentSessionURL=d.$entry(d.getCurrentSessionURL),window.FS.getCurrentSession=d.$entry(d.getCurrentSession),window.FS.enableConsole=d.$entry(d.enableConsole),window.FS.disableConsole=d.$entry(d.disableConsole),window.FS._api=d._api,window.FS.log=d.log,window.FS._cookies=d._cookies,window.FS._setCookie=d._setCookie,d._init(),d._record())}catch(z){window.console&&console.log&&console.log("Failed to initialize FullStory.")}})();
//# sourceMappingURL=/s/fs.map